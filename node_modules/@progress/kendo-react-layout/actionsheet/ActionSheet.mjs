/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2024 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use client";
import * as n from "react";
import r from "prop-types";
import { Animation as q } from "@progress/kendo-react-animation";
import { validatePackage as z, FOCUSABLE_ELEMENTS as G, Navigation as J, classNames as Q } from "@progress/kendo-react-common";
import { packageMetadata as V } from "../package-metadata.mjs";
import { ActionSheetItem as w } from "./ActionSheetItem.mjs";
import { headerDisplayName as T } from "./ActionSheetHeader.mjs";
import { footerDisplayName as W } from "./ActionSheetFooter.mjs";
import { contentDisplayName as X } from "./ActionSheetContent.mjs";
const P = n.forwardRef((e, A) => {
  var D, R;
  z(V);
  const {
    navigatableElements: K = O.navigatableElements,
    navigatable: b = O.navigatable
  } = e, _ = (t, i, a) => {
    a.preventDefault(), a.shiftKey ? i.focusPrevious(t) : i.focusNext(t);
  }, H = (t, i, a) => {
    if (t.ariaDisabled)
      return;
    const h = t.className && t.className.indexOf ? t.className.indexOf("k-actionsheet-item") !== -1 : !1, E = i.elements.filter((o) => o.className.indexOf("k-actionsheet-item") !== -1);
    if (h && e.onItemClick) {
      a.preventDefault();
      const o = e.items[E.indexOf(t)];
      e.onItemClick.call(void 0, {
        syntheticEvent: a,
        item: o,
        title: o && o.title
      });
    }
    if (h && e.onItemSelect) {
      a.preventDefault();
      const o = e.items[E.indexOf(t)];
      e.onItemSelect.call(void 0, {
        syntheticEvent: a,
        item: o,
        title: o && o.title
      });
    }
    e.animation || s();
  }, L = (t, i, a) => {
    e.onOverlayClick && (a.preventDefault(), e.onOverlayClick.call(void 0, a)), e.onClose && (a.preventDefault(), e.onClose.call(void 0, a)), e.animation || s();
  }, s = () => {
    m({ show: !1 });
  }, B = (t) => {
    b && d.current.triggerKeyboardEvent(t);
  }, F = (t) => {
    e.onOverlayClick && e.onOverlayClick.call(void 0, t), e.onClose && e.onClose.call(void 0, t), e.animation || s();
  }, y = (t) => {
    e.onItemClick && e.onItemClick.call(void 0, t), e.onItemSelect && e.onItemSelect.call(void 0, t), e.animation || s();
  }, M = (t) => {
    const i = {};
    return n.Children.forEach(t, (a) => {
      a && (i[a.type.displayName] = a);
    }), i;
  }, N = n.useRef(null), k = n.useRef(null);
  n.useImperativeHandle(N, () => ({ props: e })), n.useImperativeHandle(
    A,
    () => N.current
  );
  const d = n.useRef(), $ = n.useRef(e.animationDuration || 300), v = n.useRef({ bottom: "0", width: "100%" }), g = n.useRef(), [l, U] = n.useState({ show: !1, slide: !1 }), m = (t) => {
    U((i) => ({ ...i, ...t }));
  };
  n.useEffect(() => {
    e.expand && !l.show && m({ show: !0 });
  }, []), n.useEffect(() => {
    const t = k.current;
    if (e.expand && !l.show && m({ show: !0 }), e.expand && l.show && !l.slide && m({ slide: !0 }), !e.expand && l.show && l.slide && m({ slide: !1 }), g !== l && l.slide && t && !e.className && (t.style.setProperty("--kendo-actionsheet-height", "auto"), t.style.setProperty("--kendo-actionsheet-max-height", "none")), t && b) {
      const a = [".k-actionsheet-item", ...[
        ".k-actionsheet-footer",
        ".k-actionsheet-content",
        ".k-actionsheet-titlebar"
      ].map((h) => G.concat(K).map(
        (E) => `${h} ${E}`
      )).flat()];
      d.current = new J({
        tabIndex: e.tabIndex || 0,
        root: k,
        rovingTabIndex: !1,
        selectors: a,
        keyboardEvents: {
          keydown: {
            Tab: _,
            Enter: H,
            Escape: L
          }
        }
      }), d.current.focusElement(d.current.first, null);
    }
    g.current = { ...l };
  });
  const S = "k-actionsheet-title", x = S, c = (D = e.items) == null ? void 0 : D.filter(
    (t) => !t.group || t.group === "top"
  ), f = (R = e.items) == null ? void 0 : R.filter(
    (t) => t.group === "bottom"
  ), j = c && c.length > 0 && f && f.length > 0, u = M(e.children), C = e.animationDuration || $.current, I = l.slide && /* @__PURE__ */ n.createElement(
    "div",
    {
      className: Q("k-actionsheet", e.className, {
        "k-actionsheet-bottom": !e.className
      }),
      role: "dialog",
      "aria-modal": "true",
      "aria-hidden": !1,
      "aria-labelledby": x,
      ref: k,
      onKeyDown: B
    },
    u[T] && !e.title && !e.subTitle && u[T],
    (e.title || e.subTitle) && /* @__PURE__ */ n.createElement("div", { className: "k-actionsheet-titlebar k-text-center" }, /* @__PURE__ */ n.createElement("div", { className: "k-actionsheet-titlebar-group k-hbox" }, /* @__PURE__ */ n.createElement("div", { className: S, id: x }, e.title && /* @__PURE__ */ n.createElement("div", null, e.title), e.subTitle && /* @__PURE__ */ n.createElement("div", { className: "k-actionsheet-subtitle" }, e.subTitle)))),
    u[X] || /* @__PURE__ */ n.createElement("div", { className: "k-actionsheet-content" }, /* @__PURE__ */ n.createElement("div", { className: "k-list-ul", role: "group" }, c && c.map((t, i) => /* @__PURE__ */ n.createElement(
      w,
      {
        ...t,
        id: i,
        key: i,
        item: t,
        tabIndex: e.tabIndex || 0,
        onClick: y
      }
    ))), j && /* @__PURE__ */ n.createElement("hr", { className: "k-hr" }), /* @__PURE__ */ n.createElement("div", { className: "k-list-ul", role: "group" }, f && f.map((t, i) => /* @__PURE__ */ n.createElement(
      w,
      {
        ...t,
        id: i + ((c == null ? void 0 : c.length) || 0),
        key: i,
        item: t,
        tabIndex: e.tabIndex || 0,
        onClick: y
      }
    )))),
    u[W]
  );
  return /* @__PURE__ */ n.createElement(n.Fragment, null, e.expand || l.show ? /* @__PURE__ */ n.createElement("div", { className: "k-actionsheet-container" }, /* @__PURE__ */ n.createElement("div", { className: "k-overlay", onClick: F }), e.animation ? /* @__PURE__ */ n.createElement(
    q,
    {
      transitionName: l.slide ? "slide-up" : "slide-down",
      onExited: s,
      transitionEnterDuration: C,
      transitionExitDuration: C,
      animationEnteringStyle: e.animationStyles || v.current,
      animationEnteredStyle: e.animationStyles || v.current,
      animationExitingStyle: e.animationStyles || v.current,
      exit: !0,
      enter: !0,
      appear: !1
    },
    I
  ) : I) : null);
}), O = {
  navigatable: !0,
  navigatableElements: []
};
P.propTypes = {
  items: r.array,
  subTitle: r.string,
  title: r.string,
  navigatable: r.bool,
  navigatableElements: r.array
};
P.displayName = "KendoReactActionSheet";
export {
  P as ActionSheet,
  O as actionSheetDefaultProps
};
