/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2024 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use client";"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const b=require("react"),l=require("prop-types"),v=require("./PanelBarItem.js"),p=require("./util.js"),o=require("@progress/kendo-react-common"),k=require("../package-metadata.js"),a=require("./interfaces/NavigationAction.js");function P(d){const n=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(d){for(const r in d)if(r!=="default"){const e=Object.getOwnPropertyDescriptor(d,r);Object.defineProperty(n,r,e.get?e:{enumerable:!0,get:()=>d[r]})}}return n.default=d,Object.freeze(n)}const u=P(b),g=class g extends u.Component{constructor(n){super(n),this._element=null,this.showLicenseWatermark=!1,this.handleSelect=e=>{this.onSelect(e),this.onFocus(e)},this.onSelect=e=>{const c=p.flatChildren(u.Children.toArray(this.children));let i,s;switch(c.forEach(t=>{t.props.uniquePrivateKey===(e.uniquePrivateKey||this.state.focused)&&(i=t)}),this.expandMode){case"single":s=[...i.props.parentUniquePrivateKey,i.props.uniquePrivateKey],p.isArrayEqual(this.expandedItems,s)&&(i.props.parentUniquePrivateKey?s=[...i.props.parentUniquePrivateKey]:s=[]);break;case"multiple":{s=this.expandedItems.slice();const t=s.indexOf(i.props.uniquePrivateKey);t===-1?s.push(i.props.uniquePrivateKey):s.splice(t,1);break}default:s=this.expandedItems.slice();break}this.setState({selected:i.props.uniquePrivateKey,expanded:s}),this.props.onSelect&&this.props.onSelect.call(void 0,{target:i,expandedItems:s})},this.onFocus=(e,c=0,i)=>{const s=p.flatVisibleChildren(u.Children.toArray(this.children)),t=p.getFocusedChild(s,c,e,this.state.focused,i);if(t){const h=this.expandedItems.slice();if(i===a.NavigationAction.Right&&t&&t.props&&t.props.children&&t.props.children.length>0){if(h.push(t.props.uniquePrivateKey),this.setState({expanded:[...new Set(h)]}),t.props.expanded){const f=t.props.children[0].props.uniquePrivateKey;this.setState({focused:f})}}else if(i===a.NavigationAction.Left&&(t&&t.props&&t.props.parentUniquePrivateKey&&t.props.parentUniquePrivateKey.length>0||t&&t.props&&!t.props.disabled&&t.props.children&&t.props.children.length>0)){const f=t.props.parentUniquePrivateKey;if(t.props.expanded){const m=t.props.uniquePrivateKey,x=h.indexOf(m);h.splice(x,1),this.setState({expanded:h})}else if(t.props.level>0){const m=t.props.parentUniquePrivateKey[f.length-1];this.setState({focused:m})}}else this.activeDescendant=t.props.id,this.setState({focused:t.props.uniquePrivateKey})}},this.onNavigate=(e,c)=>{let i;switch(c){case a.NavigationAction.First:this.onFocus(e,i,a.NavigationAction.First);break;case a.NavigationAction.Last:this.onFocus(e,i,a.NavigationAction.Last);break;case a.NavigationAction.Left:this.onFocus(e,i,a.NavigationAction.Left);break;case a.NavigationAction.Right:this.onFocus(e,i,a.NavigationAction.Right);break;case a.NavigationAction.Previous:i=-1,this.onFocus(e,i);break;case a.NavigationAction.Next:i=1,this.onFocus(e,i);break;case a.NavigationAction.Toggle:this.onSelect(e);break}},this.handleWrapperFocus=()=>{clearTimeout(this.nextTickId),this.state.wrapperFocused||this.setState({wrapperFocused:!0})},this.handleWrapperBlur=()=>{this.nextTick(()=>{this.setState({wrapperFocused:!1})})},this.handleKeyDown=e=>{const c=this._element&&getComputedStyle(this._element).direction==="rtl"||!1;if(e.target===e.currentTarget){const i=e.keyCode;let s;switch(i){case o.Keys.left:s=c?a.NavigationAction.Right:a.NavigationAction.Left;break;case o.Keys.up:s=a.NavigationAction.Previous;break;case o.Keys.right:s=c?a.NavigationAction.Left:a.NavigationAction.Right;break;case o.Keys.down:s=a.NavigationAction.Next;break;case o.Keys.home:s=a.NavigationAction.First;break;case o.Keys.end:s=a.NavigationAction.Last;break;case o.Keys.space:case o.Keys.enter:s=a.NavigationAction.Toggle;break;default:s=null;break}s!==null&&(e.preventDefault(),this.onNavigate(e,s))}},o.validatePackage(k.packageMetadata),this.showLicenseWatermark=o.shouldShowValidationUI(k.packageMetadata);const r=p.getInitialState(n,this.expandMode);r.focused||(r.focused=p.getFirstId(n)),this.state=r}get expandMode(){return this.props.expandMode||"multiple"}get selectedItem(){const{selected:n=this.state.selected}=this.props;return n}get expandedItems(){return this.props.isControlled?this.props.expanded||[]:this.state.expanded}get children(){const n={...this.state,selected:this.selectedItem},r={animation:this.props.animation,keepItemsMounted:this.props.keepItemsMounted,state:n,expanded:this.expandedItems,handleSelect:this.handleSelect,children:this.props.children};return p.renderChildren(r)}render(){const n={"aria-activedescendant":this.activeDescendant},r=o.classNames("k-panelbar",this.props.className);return u.createElement("ul",{ref:e=>{this._element=e},dir:this.props.dir,role:"tree",tabIndex:0,onKeyDown:this.handleKeyDown,onFocus:this.handleWrapperFocus,onBlur:this.handleWrapperBlur,className:r,style:this.props.style,...n},this.children,this.showLicenseWatermark&&u.createElement(o.WatermarkOverlay,null))}nextTick(n){this.nextTickId=window.setTimeout(()=>n())}};g.propTypes={animation:l.bool,children:function(n,r){const e=n[r];if(e){if(Array.isArray(e)){for(const c of e)if(!c.type||c.type!==v.PanelBarItem)return new Error("PanelBar children should be either PanelBarItem or Array of PanelBarItem.")}else if(e.type!==v.PanelBarItem)return new Error("PanelBar child should be either PanelBarItem or Array of PanelBarItem.");return null}return null},dir:l.string,selected:l.string,expanded:l.arrayOf(l.string),focused:l.string,expandMode:l.oneOf(["single","multiple"]),className:l.string,keepItemsMounted:l.bool,onSelect:l.func,style:l.object},g.defaultProps={expandMode:"multiple",animation:!0,keepItemsMounted:!1};let y=g;exports.PanelBar=y;
